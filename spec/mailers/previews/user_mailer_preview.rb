# Preview all emails at http://localhost:3000/rails/mailers/user_mailer
class UserMailerPreview < ActionMailer::Preview
  def rebalance_notification_email 
    rebalance = FactoryBot.create(:rebalance)

    rebalance.update(
      before_state: [{"price"=>"38.69",
      "currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "quantity"=>"100.0",
      "asset_price"=>
       {"id"=>7,
        "price"=>"38.69",
        "status"=>"updated",
        "asset_id"=>5,
        "created_at"=>"2024-07-08T18:11:11.992Z",
        "updated_at"=>"2024-07-20T11:43:13.086Z",
        "currency_id"=>3,
        "last_sync_at"=>"2024-07-20T11:43:13.060Z",
        "scheduled_at"=>"2024-07-20T11:43:09.841Z",
        "error_message"=>nil,
        "ticker_symbol"=>"PETR4",
        "reference_date"=>"2024-07-19T20:07:45.000Z",
        "partner_resource_id"=>3},
      "ticker_symbol"=>"PETR4",
      "original_price"=>"38.69",
      "target_quantity"=>"88.705091754975445851641250969242698372",
      "original_currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "target_total_value"=>"3432.0",
      "current_total_value"=>"3869.0",
      "quantity_adjustment"=>"-11.294908245024554148358749030757301628",
      "current_deviation_percentage"=>"3.1832750582750582750582750582750583",
      "currency_parity_exchange_rate"=>nil,
      "target_variation_limit_percentage"=>"0.0",
      "target_allocation_weight_percentage"=>"25.0",
      "current_allocation_weight_percentage"=>"28.1832750582750582750582750582750583"},
     {"price"=>"61.12",
      "currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "quantity"=>"100.0",
      "asset_price"=>
       {"id"=>13,
        "price"=>"61.12",
        "status"=>"updated",
        "asset_id"=>9,
        "created_at"=>"2024-07-08T18:11:30.946Z",
        "updated_at"=>"2024-07-20T11:43:12.263Z",
        "currency_id"=>3,
        "last_sync_at"=>"2024-07-20T11:43:12.249Z",
        "scheduled_at"=>"2024-07-20T11:43:09.889Z",
        "error_message"=>nil,
        "ticker_symbol"=>"VALE3",
        "reference_date"=>"2024-07-19T20:07:58.000Z",
        "partner_resource_id"=>3},
      "ticker_symbol"=>"VALE3",
      "original_price"=>"61.12",
      "target_quantity"=>"56.151832460732984293193717277486910995",
      "original_currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "target_total_value"=>"3432.0",
      "current_total_value"=>"6112.0",
      "quantity_adjustment"=>"-43.848167539267015706806282722513089005",
      "current_deviation_percentage"=>"19.5221445221445221445221445221445221",
      "currency_parity_exchange_rate"=>nil,
      "target_variation_limit_percentage"=>"0.0",
      "target_allocation_weight_percentage"=>"25.0",
      "current_allocation_weight_percentage"=>"44.5221445221445221445221445221445221"},
     {"price"=>"27.11",
      "currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "quantity"=>"100.0",
      "asset_price"=>
       {"id"=>2655,
        "price"=>"27.11",
        "status"=>"updated",
        "asset_id"=>8,
        "created_at"=>"2024-07-20T02:06:02.527Z",
        "updated_at"=>"2024-07-20T11:50:45.746Z",
        "currency_id"=>3,
        "last_sync_at"=>"2024-07-20T11:50:45.733Z",
        "scheduled_at"=>"2024-07-20T11:50:39.392Z",
        "error_message"=>nil,
        "ticker_symbol"=>"BBAS3",
        "reference_date"=>"2024-07-19T20:07:48.000Z",
        "partner_resource_id"=>3},
      "ticker_symbol"=>"BBAS3",
      "original_price"=>"27.11",
      "target_quantity"=>"126.595352268535595721136112135743268167",
      "original_currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "target_total_value"=>"3432.0",
      "current_total_value"=>"2711.0",
      "quantity_adjustment"=>"26.595352268535595721136112135743268167",
      "current_deviation_percentage"=>"-5.252039627039627039627039627039627",
      "currency_parity_exchange_rate"=>nil,
      "target_variation_limit_percentage"=>"0.0",
      "target_allocation_weight_percentage"=>"25.0",
      "current_allocation_weight_percentage"=>"19.747960372960372960372960372960373"},
     {"price"=>"10.36",
      "currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "quantity"=>"100.0",
      "asset_price"=>
       {"id"=>23,
        "price"=>"10.36",
        "status"=>"updated",
        "asset_id"=>15,
        "created_at"=>"2024-07-08T18:11:56.856Z",
        "updated_at"=>"2024-07-20T11:43:12.554Z",
        "currency_id"=>3,
        "last_sync_at"=>"2024-07-20T11:43:12.542Z",
        "scheduled_at"=>"2024-07-20T11:43:09.980Z",
        "error_message"=>nil,
        "ticker_symbol"=>"ITSA4",
        "reference_date"=>"2024-07-19T20:07:32.000Z",
        "partner_resource_id"=>3},
      "ticker_symbol"=>"ITSA4",
      "original_price"=>"10.36",
      "target_quantity"=>"331.274131274131274131274131274131274131",
      "original_currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "target_total_value"=>"3432.0",
      "current_total_value"=>"1036.0",
      "quantity_adjustment"=>"231.274131274131274131274131274131274131",
      "current_deviation_percentage"=>"-17.4533799533799533799533799533799534",
      "currency_parity_exchange_rate"=>nil,
      "target_variation_limit_percentage"=>"0.0",
      "target_allocation_weight_percentage"=>"25.0",
      "current_allocation_weight_percentage"=>"7.5466200466200466200466200466200466"}],
      after_state: [{"price"=>"38.69",
      "currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "quantity"=>"88.705091754975445851641250969242698372",
      "asset_price"=>
       {"id"=>7,
        "price"=>"38.69",
        "status"=>"updated",
        "asset_id"=>5,
        "created_at"=>"2024-07-08T18:11:11.992Z",
        "updated_at"=>"2024-07-20T11:43:13.086Z",
        "currency_id"=>3,
        "last_sync_at"=>"2024-07-20T11:43:13.060Z",
        "scheduled_at"=>"2024-07-20T11:43:09.841Z",
        "error_message"=>nil,
        "ticker_symbol"=>"PETR4",
        "reference_date"=>"2024-07-19T20:07:45.000Z",
        "partner_resource_id"=>3},
      "ticker_symbol"=>"PETR4",
      "original_price"=>"38.69",
      "target_quantity"=>"88.705091754975445851641250969242698372",
      "original_currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "target_total_value"=>"3432.0",
      "current_total_value"=>"3432.00000000000000000000000000000000001268",
      "quantity_adjustment"=>"0.0",
      "current_deviation_percentage"=>"0.0000000000000000000000000000000000000923659673659673659673659673659673659673659673659674",
      "currency_parity_exchange_rate"=>nil,
      "target_variation_limit_percentage"=>"0.0",
      "target_allocation_weight_percentage"=>"25.0",
      "current_allocation_weight_percentage"=>"25.0000000000000000000000000000000000000923659673659673659673659673659673659673659673659674"},
     {"price"=>"61.12",
      "currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "quantity"=>"56.151832460732984293193717277486910995",
      "asset_price"=>
       {"id"=>13,
        "price"=>"61.12",
        "status"=>"updated",
        "asset_id"=>9,
        "created_at"=>"2024-07-08T18:11:30.946Z",
        "updated_at"=>"2024-07-20T11:43:12.263Z",
        "currency_id"=>3,
        "last_sync_at"=>"2024-07-20T11:43:12.249Z",
        "scheduled_at"=>"2024-07-20T11:43:09.889Z",
        "error_message"=>nil,
        "ticker_symbol"=>"VALE3",
        "reference_date"=>"2024-07-19T20:07:58.000Z",
        "partner_resource_id"=>3},
      "ticker_symbol"=>"VALE3",
      "original_price"=>"61.12",
      "target_quantity"=>"56.151832460732984293193717277486910995",
      "original_currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "target_total_value"=>"3432.0",
      "current_total_value"=>"3432.0000000000000000000000000000000000144",
      "quantity_adjustment"=>"0.0",
      "current_deviation_percentage"=>"0.0000000000000000000000000000000000001048951048951048951048951048951048951048951048951049",
      "currency_parity_exchange_rate"=>nil,
      "target_variation_limit_percentage"=>"0.0",
      "target_allocation_weight_percentage"=>"25.0",
      "current_allocation_weight_percentage"=>"25.0000000000000000000000000000000000001048951048951048951048951048951048951048951048951049"},
     {"price"=>"27.11",
      "currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "quantity"=>"126.595352268535595721136112135743268167",
      "asset_price"=>
       {"id"=>2655,
        "price"=>"27.11",
        "status"=>"updated",
        "asset_id"=>8,
        "created_at"=>"2024-07-20T02:06:02.527Z",
        "updated_at"=>"2024-07-20T11:50:45.746Z",
        "currency_id"=>3,
        "last_sync_at"=>"2024-07-20T11:50:45.733Z",
        "scheduled_at"=>"2024-07-20T11:50:39.392Z",
        "error_message"=>nil,
        "ticker_symbol"=>"BBAS3",
        "reference_date"=>"2024-07-19T20:07:48.000Z",
        "partner_resource_id"=>3},
      "ticker_symbol"=>"BBAS3",
      "original_price"=>"27.11",
      "target_quantity"=>"126.595352268535595721136112135743268167",
      "original_currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "target_total_value"=>"3432.0",
      "current_total_value"=>"3432.00000000000000000000000000000000000737",
      "quantity_adjustment"=>"0.0",
      "current_deviation_percentage"=>"0.0000000000000000000000000000000000000536858974358974358974358974358974358974358974358974",
      "currency_parity_exchange_rate"=>nil,
      "target_variation_limit_percentage"=>"0.0",
      "target_allocation_weight_percentage"=>"25.0",
      "current_allocation_weight_percentage"=>"25.0000000000000000000000000000000000000536858974358974358974358974358974358974358974358974"},
     {"price"=>"10.36",
      "currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "quantity"=>"331.274131274131274131274131274131274131",
      "asset_price"=>
       {"id"=>23,
        "price"=>"10.36",
        "status"=>"updated",
        "asset_id"=>15,
        "created_at"=>"2024-07-08T18:11:56.856Z",
        "updated_at"=>"2024-07-20T11:43:12.554Z",
        "currency_id"=>3,
        "last_sync_at"=>"2024-07-20T11:43:12.542Z",
        "scheduled_at"=>"2024-07-20T11:43:09.980Z",
        "error_message"=>nil,
        "ticker_symbol"=>"ITSA4",
        "reference_date"=>"2024-07-19T20:07:32.000Z",
        "partner_resource_id"=>3},
      "ticker_symbol"=>"ITSA4",
      "original_price"=>"10.36",
      "target_quantity"=>"331.274131274131274131274131274131274131",
      "original_currency"=>{"id"=>3, "code"=>"BRL", "name"=>"Brazilian Real", "created_at"=>"2024-07-08T18:06:29.034Z", "updated_at"=>"2024-07-08T18:06:29.034Z"},
      "target_total_value"=>"3432.0",
      "current_total_value"=>"3431.99999999999999999999999999999999999716",
      "quantity_adjustment"=>"0.0",
      "current_deviation_percentage"=>"-0.0000000000000000000000000000000000000206876456876456876456876456876456876456876456876457",
      "currency_parity_exchange_rate"=>nil,
      "target_variation_limit_percentage"=>"0.0",
      "target_allocation_weight_percentage"=>"25.0",
      "current_allocation_weight_percentage"=>"24.9999999999999999999999999999999999999793123543123543123543123543123543123543123543123543"}],
      details: {"rebalance_order_kind"=>"default", "rebalance_order_amount"=>"0.0", "investment_portfolio_id"=>8, "investment_portfolio_projected_total_value"=>"13728.0"},
      recommended_actions: {"buy"=>
      [{"quantity"=>"26.595352268535595721136112135743268167", "ticker_symbol"=>"BBAS3"},
       {"quantity"=>"231.274131274131274131274131274131274131", "ticker_symbol"=>"ITSA4"}],
     "sell"=>
      [{"quantity"=>"11.294908245024554148358749030757301628", "ticker_symbol"=>"PETR4"},
       {"quantity"=>"43.848167539267015706806282722513089005", "ticker_symbol"=>"VALE3"}]}
    )
    UserMailer.rebalance_notification_email('felipehenssler@gmail.com', rebalance)
  end
end
